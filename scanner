#! /bin/bash
normal=$(tput sgr0)
bold=$(tput bold)
figlet vulnScan
echo
echo
if [ "$1" == '-h' ] || [ "$#" -lt 3 ];
then
    echo "usage: $0 -t [Scan Type] -d [domain]"
	echo "-t port: port scan"
	echo "-t xss: scan for xss"
	echo "-t openredirect: scan for open rediredction"
	echo "-t sqli: scan for sql injection"
else
	echo "Scanning......."
	if [ "$2" == "xss" ];
	then
		waybackurls $4 |
		grep "=" | 
		egrep -iv ".(jpg|jpeg|gif|css|tif|tiff|png|ttf|woff|woff2|ico|pdf|svg|txt|js)"| 
		qsreplace '"><script>confirm(1)</script>' | 
	 	tee finalfuzz.json &&
		cat finalfuzz.json |
		while read host do; 
		do curl --silent --path-as-is --insecure "$host" | 
		grep -qs "<script>confirm(1)" && 
		echo -e "\e[31m $bold Vulnerable  $normal $host\n";
		done
	elif [ "$2" == "openredirect" ];
	then
		waybackurls $4 |
 		grep -a -i \=http | 
		qsreplace 'http://evil.com' | 
		while read host do; do curl -s -L $host -I| 
		grep "evil.com" && echo -e "$bold \e[31m Vulnerable $normal $host\n"; 
		done
	elif [ "$2" == "sqli" ];
	then
		waybackurls $4 |
 		grep -a -i \=http | 
		qsreplace "1' ORDER BY 1--+" | 
		while read host do; 
		do curl --silent --path-as-is --insecure $host | 
		grep "evil.com" && echo -e " \e[31m $bold Vulnerable(possible) $normal $host\n";
		done
	elif [ "$2" == "port" ];
	then
		sudo nmap -sN -sC $4;
	else
		echo "Better Luck Next Time!"
		fi
fi
